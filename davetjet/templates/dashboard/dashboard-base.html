{% load static %}

<!DOCTYPE html>
<html lang="tr">
  <head>
    <!-- Basic Meta -->
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">

    <!-- SEO -->
    <title>
      {% block title %}DavetJet | Dijital Davetiye Paneli{% endblock %}
    </title>
    <meta
      name="description"
      content="DavetJet ile dijital davetiye hazırlayın, gönderin ve katılımı yönetin. Hızlı, etkili ve şık."
    />
    <meta
      name="keywords"
      content="dijital davetiye, düğün davetiyesi, davet yönetimi, rsvp, davetjet"
    />
    <meta name="author" content="DavetJet" />
    <link rel="canonical" href="https://davetjet.com/" />

    <!-- Open Graph (Facebook, WhatsApp) -->
    <meta property="og:title" content="DavetJet | Dijital Davetiye Paneli" />
    <meta
      property="og:description"
      content="Davetiye hazırlayın, gönderin ve katılımı yönetin."
    />
    <meta property="og:image" content="{% static 'images/og-image.jpg' %}" />
    <meta property="og:url" content="https://davetjet.com/" />
    <meta property="og:type" content="website" />

    <!-- Twitter Cards -->
    <meta name="twitter:title" content="DavetJet | Dijital Davetiye Paneli" />
    <meta
      name="twitter:description"
      content="Davetiye hazırlayın, gönderin ve katılımı yönetin."
    />
    <meta name="twitter:image" content="{% static 'images/og-image.jpg' %}" />
    <meta name="twitter:card" content="summary_large_image" />

    <!-- Favicon -->
    <link rel="icon" href="{% static 'favicon.ico' %}" type="image/x-icon" />
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="{% static 'apple-touch-icon.png' %}"
    />
    <link rel="manifest" href="{% static 'site.webmanifest' %}" />

    <!-- Fonts & Icons -->
    <script
      src="https://kit.fontawesome.com/83fb529190.js"
      crossorigin="anonymous"
    ></script>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&family=Roboto:ital,wght@0,100..900;1,100..900&display=swap"
      rel="stylesheet"
    />

    <!-- CSS -->
    <link rel="stylesheet" href="{% static 'css/main.css' %}" />
    <script src="{% static 'scripts/app.js' %}" type="module" defer></script>

    {% block extra_css %}{% endblock %}

    <!-- Scripts (head) -->
    {% block head_scripts %}{% endblock %}
  </head>

  <body data-page="{% block body-page %}{% endblock %}"> 
    <div class="custom-cursor"></div>
    <div class="blur-circle top-left"></div>
    <div class="blur-circle bottom-right"></div>
    {% include '../utils/modal-window.html' %}
    {% include '../utils/notifications-window.html' %}
    <audio id="notificationSound" src="{% static 'sounds/notification-sound.mp3' %}" preload="auto"></audio>

    {% if messages %}
    <div id="msgbar" class="msgbar" aria-live="polite" aria-atomic="true">
      {% for message in messages %}
      <div
        class="dj-msg {{ message.tags|default:'info' }}"
        role="{% if message.level_tag == 'error' %}alert{% else %}status{% endif %}"
        data-timeout="{% if 'persistent' in message.tags %}0{% else %}5000{% endif %}"
      >
        <span class="icon" aria-hidden="true"></span>
        <div class="text">{{ message }}</div>
        <button class="close" aria-label="Kapat">&times;</button>
        <div class="progress"></div>
      </div>
      {% endfor %}
    </div>
    {% endif %}


    {% block top_content %} {% endblock %}


    <div class="dashboard">

<!-- SIDEBAR -->
<aside id="sidebar" class="sidebar" data-collapsed="false" aria-label="Kenar Menü">


 {% with name=request.resolver_match.url_name %}

<div class="menu">
  <div class="menu-settings">
    <h3>MENU</h3>
    <ul>
      <li class="{% if name == 'dashboard' %}active{% endif %}">
        <a href="{% url 'core:dashboard' %}" class="sb-item" {% if name == 'dashboard' %}aria-current="page"{% endif %}>
          <i class="fa-regular fa-house"></i>
          <span class="label">Genel Bakış</span>
        </a>
      </li>

      {# Davetiyeler: liste/oluştur/düzenle/detay/drafts #}
      {% with name=request.resolver_match.url_name %}
        <li class="{% if name == 'invitations' or name == 'edit-invitation' or name == 'create_invitation' or name == 'edit_invitation' or name == 'invitation_drafts' %}active{% endif %}">
          <a href="{% url 'core:invitations' %}" class="sb-item" {% if name == 'invitations' or name == 'edit-invitation' or name == 'create_invitation' or name == 'edit_invitation' or name == 'invitation_drafts' %}aria-current="page"{% endif %}>
            <i class="fa-regular fa-envelope"></i>
            <span class="label">Davetiyeler</span>
          </a>
        </li>
      {% endwith %}


      {# Davetli listesi: ana/editle/upload vs. #}
      {% with name=request.resolver_match.url_name %}
<li class="{% if name == 'recipients' or name == 'edit-recipients' or name == 'recipients_upload' or name == 'project_recipients' %}active{% endif %}">
  <a href="{% url 'core:recipients' %}" class="sb-item"
     {% if name == 'recipients' or name == 'edit-recipients' or name == 'recipients_upload' or name == 'project_recipients' %}aria-current="page"{% endif %}>
    <i class="fa-solid fa-users"></i>
    <span class="label">Davetli Listesi</span>
  </a>
</li>
{% endwith %}


    {% with name=request.resolver_match.url_name %}
<li class="{% if name == 'sending' %}active{% endif %}">
  <a href="{% url 'core:sending' %}" class="sb-item"
     {% if name == 'sending' %}aria-current="page"{% endif %}>
    <i class="fa-solid fa-paper-plane"></i>
    <span class="label">Gönderim</span>
  </a>
</li>
{% endwith %}

      {% with name=request.resolver_match.url_name %}
<li class="{% if name == 'analytics' or name == 'analytics_detail' %}active{% endif %}">
  <a href="{% url 'core:analytics' %}" class="sb-item"
     {% if name == 'analytics' or name == 'analytics_detail' %}aria-current="page"{% endif %}>
    <i class="fa-solid fa-chart-simple"></i>
    <span class="label">İstatistikler</span>
  </a>
</li>
{% endwith %}
      
    </ul>
  </div>

  <div class="gen-settings">
    <h3>GENEL</h3>
    <ul>
      <li class="{% if name == 'package' %}active{% endif %}">
        <a href="{% url 'core:package' %}" class="sb-item" {% if name == 'package' %}aria-current="page"{% endif %}>
          <i class="fa-solid fa-cart-shopping"></i>
          <span class="label">Paketim</span>
        </a>
      </li>

      <li>
        <a id="navHelpTour" class="sb-item" aria-label="Yardım / Hızlı Tur">
          <i class="fa-solid fa-circle-question" aria-hidden="true"></i>
          <span class="label">Yardım</span>
        </a>
      </li>

      <li>
        <a href="{% url 'core:logout' %}" class="sb-item">
          <i class="fa-solid fa-power-off"></i>
          <span class="label">Oturumu Kapat</span>
        </a>
      </li>
    </ul>
  </div>

  <div class="premium-box {% if name == 'subscribe' %}active{% endif %}">
    <a href="{% url 'core:subscribe' %}" class="sb-item" {% if name == 'subscribe' %}aria-current="page"{% endif %}>
      <i class="fa-solid fa-crown" style="color: white;"></i>
      <span class="label">Şimdi Premium Ol!</span>
    </a>
  </div>
</div>

{% endwith %}


  <!-- Desktop daraltma düğmesi -->
  <button id="sbCollapse" class="sb-collapse" type="button" aria-label="Menüyü daralt/genişlet">⟷</button>
</aside>
        <div id="sidebarBackdrop" class="sidebar-backdrop" hidden></div>


      <!-- Main Content -->
      <main class="main-content">
        <header class="top-bar">
          <button id="dashHamburger" class="hamburger-btn" aria-controls="sidebar" aria-expanded="false" aria-label="Menüyü aç/kapat">
            <span class="bar"></span><span class="bar"></span><span class="bar"></span>
          </button>
          <label for="search-input" style="position: relative; display: inline-block;">
          <input
            type="text"
            name="search"
            id="search-input"
            placeholder="Aramaya başla..."
            class="search-input"
            autocomplete="off"
            spellcheck="false"
          />
          
          <ul id="search-suggestions" class="suggestions-list" role="listbox" aria-label="Search suggestions"></ul>
        </label>



          <div class="top-actions">
              <button id="taskTrigger" class="task-trigger" aria-haspopup="dialog" aria-controls="taskDrawer" aria-expanded="false" title="Görevler">
              <i class="fa-solid fa-list-check"></i>
              <span class="badge-pulse hidden" id="notificationBadge" aria-label="Bekleyen görev sayısı"></span>
            </button>
            <button class="notification-trigger">
              <i class="fa-regular fa-bell"></i>
              <span class="badge-pulse hidden" id="notificationBadge"></span>

            </button>
            <div class="user-info">
              <img src="{% static 'images/avatar.png' %}" alt="Avatar" />
              <span class="user-details">
                <span>{{ request.user.username }}</span>
                <small>{{ request.user.email }}</small>
              </span>
            </div>
          </div>
        </header>
        {% block content %} {% endblock %}
      </main>
    </div>

    <!-- TASK DRAWER -->
    <aside id="taskDrawer" class="task-drawer" aria-hidden="true" aria-label="Görevler">
      <header class="td-head">
        <div class="td-title">
          <i class="fa-solid fa-bullseye"></i>
          <strong>Görevler</strong>
        </div>
        <button id="taskDrawerClose" class="td-close" aria-label="Kapat">×</button>
      </header>

      <div class="td-progress">
        <div class="td-progress__bar"><span id="tdProgressFill" style="width:0%"></span></div>
        <small id="tdProgressText">0 / 0 tamamlandı</small>
      </div>

      <ul id="taskList" class="td-list"></ul>

      <footer class="td-foot">
        <button id="tdStartPageTour" class="btn btn--success" type="button">
          <i class="fa-regular fa-circle-question"></i> Bu sayfanın turunu başlat
        </button>
      </footer>
    </aside>

    <!-- Global Scripts -->
    <script src="{% static 'scripts/searchBar.js' %}" defer></script>
    <script src="{% static 'scripts/modal.js' %}" defer></script>
    <script src="{% static 'scripts/notifications.js' %}" defer></script>
    <script src="{% static 'scripts/sidebar.js' %}" defer></script>
    <script src="{% static 'scripts/messages.js' %}" defer></script>
    <script src="{% static 'scripts/onboard.js' %}" defer></script>
    {% block extra_js %}{% endblock %}
  </body>
</html>
